<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="styles.css">
    <title>Xiao Demo</title>
  </head>
  <body>
    <header>
      <svg aria-hidden="true" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="73.548mm" width="180.34mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 638.98263 260.60408">
       <g transform="translate(838.41 -52.495)">
        <path style="stroke-width:0;fill:#000000" d="m258.98 0v19.867h20v-19.867h-20zm120.72 1.0098v20h20v-20l-20-.0002zm20 20v20h20v-20h-20zm20 20v20h20v-20h-20zm20 20v80h-100v-80h-20v199.59h20v-99.59h100v98.58h20v-198.58h-20zm-100 0h20v-20h-20v20zm20-20h20v-20h-20v20zm199.42-40v20h20v-20l-20-.0002zm20 20v20h20v-20h-20zm20 20v20h19.86v138.58h20v-138.58h-19.86v-20h-20zm-40-20h-20v20h20v-20zm-20 20h-20v20h20v-20zm-280.14-1.143v219.72h20v-219.72l-20-.003zm-100 .051v20h20v-20h-20zm0 20h-20v20h20v-20zm-119.62-19.627v20h20v-20h-20zm20 20v20h20v-20h-20zm20 20v19.999h20v-19.999h-20zm419.62-19.281v138.58h20v-138.58h-20zm-380.21 19.404v19.996h20v-19.996h-20zm79.3.383v20.003h20v-20.003h-20zm0 20.003h-20v20h20v-20zm-198.07-19.575v19.995h20v-19.995h-20zm20 19.995v20h20v-20h-20zm20 20v20h20v-20h-20zm20 20v19.21h-19v20h20v-19.21h18.494v19.5h19.5v19.07h-19.916v20h20v-19.57h19.912v-20h-19.496v-19.5h-19.494v-19.5h-20zm58.99 59v20h20v-20h-20zm20 20v20h20v-20h-20zm20 20v20h20v-20h-20zm-79.912-20.43h-20v20h-20v20h20v-20h20v-20zm-38.078-39.36h-20v20h20v-20zm-20 20h-20v20h20v-20zm77.984-100.01v20h19.996v-20h-19.996zm20.376 19.87v20h20v-20h-20zm-39.788.50v20h20v-20h-20zm80.218.64v20h20v-20h-20zm-20.29 19.37v20h20v-20h-20zm20.29 19.56v20h19.28v20h20v-20h-19.28v-20h-20zm39.28 40v20h20v-20h-20zm-79.63-39.85v20h20v-20h-20zm399.68 40.07v20h20v-20h-20zm20 20v20h20v-20h-20zm20 20v20h20v-20h-20zm20 0h20v-20h-20v20zm20-20h20v-20h-20v20z" transform="translate(-838.41 52.495)"/>
       </g>
      </svg>
      <nav>
        <ul>
          <li><a href="#home">Home</a></li>
          <li><a href="#lifecycle">Lifecycle</a></li>
          <li><a href="#subsections">Subsections</a></li>
          <li><a href="#params?foo=bar">Params example</a></li>
        </ul>
      </nav>
    </header>
    <main>
      <div id="home">
        <h1>Welcome to the Xiao demo page</h1>
        <p>Xiao is a small, accessible, framework agnostic, browser-driven routing system. Make single page applications with progressive enhancement. This demo is an incomplete exploration of Xiao. See <a href="https://github.com/Heydon/xiao/blob/master/README.md">the README</a> for more.</p>
        <p>This is the default route, <code>home</code>, and just contains static content, loaded with the web page from the server. Note the <code>id="home"</code> attribution in the HTML:</p>
<pre><code>&lt;div id="home">
  &lt;h1>A demo built with Xiao&lt;/h1>
  &lt;p>Xiao is a small, accessible, framework agnostic, browser-driven routing system. Make single page applications with progressive enhancement and without the complexity.&lt;/p>
  &lt;p>This is the default route, &lt;code>home&lt;/code>, and just contains static content, loaded with the web page from the server. Note the &lt;code>id="home"&lt;/code> attribution in the HTML:&lt;/p>
&lt;/div></code></pre>
        <p>To make Xiao recognize this element as a route element, you add it to a routes array when you instantiate the app.</p>
<pre><code>var app = new Xiao([{ id: 'home', label: 'Home'  }], 'home')</code></pre>
        <p>The second argument defines the default route, which will be activated if no route hash is provided in the web address on page load.</p>
        <h2>Accessibility semantics</h2>
        <p>Route elements are given assistive technology accessible information when a Xiao app is initialized. Note <code>role="region"</code> and <code>aria-label="Home"</code> (from the route object's <code>label</code> property):</p>
<pre><code>&lt;div id="home" <span class="hl">role="region"</span> <span class="hl">aria-label="Home"</span>>
  &lt;h1>A demo built with Xiao&lt;/h1>
  &lt;p>Xiao is a small, accessible, framework agnostic, browser-driven routing system. Make single page applications with progressive enhancement and without the complexity.&lt;/p>
  &lt;p>This is the default route, &lt;code>home&lt;/code>, and just contains static content, loaded with the web page from the server. Note the &lt;code>id="home"&lt;/code> attribution in the HTML:&lt;/p>
&lt;/div></code></pre>
        <div id="focus-management">
          <h2>Focus management</h2>
          <p>Whenever the hash changes in a Xiao routed app's URL, Xiao determines if it corresponds to a route or an element inside a route. If so, it will move focus to that element. This will move keyboard users into the correct position, and elicit the announcement of accessibility information in screen readers. For example: <em>"main, region, XHR content"</em>.</p>
          <p>Try opening developer tools, clicking <a href="#subsections">this Subsections link</a>, then entering <code>document.activeElement</code> into your console. The active element is the focused element.</p>
        </div>
      </div>
      <div id="lifecycle">
        <h1>Route lifecycles</h1>
        <p>Routes have a lifecycle that begins with the user's arrival at the route and ends with their departure. You can tap into these lifecycle events with the <code>arrived</code> and <code>departed</code> methods.</p>
        <p>For example, I can record the arrival time as a timestamp and write it to the page, like this:</p>
<pre><code>id: 'lifecycle',
label: 'Route lifecycle',
arrived(elem) {
  var time = Date.now();
  var dynamicElem = elem.querySelector('.timestamp')
  dynamicElem.textContent = `Route arrival timestamp: ${time}`
}</code></pre>
        <div class="timestamp box"></div>
        <p>If you refresh the page, the timestamp updates. It also updates when you move to another route and come back. Obviously, this is a silly example. You're more likely to use the <code>arrived</code> method to load XHR content and/or compile some templates. That sort of thing.</p>
        <h2>The departed method</h2>
        <p>The departed method fires when the user leaves the route. One use may be to save some route-related data to <code>localStorage</code>. Below, you should see the message "Welcome!" if it is your first time at this route or "Welcome back!" if you've been here before.</p>
        <div class="box welcome"></div>
        <p>We set the storage item on <code>departed</code>&hellip;</p>
<pre><code>departed(elem) {
  window.localStorage.setItem('visited', true)
}
</code></pre>
        <p>&hellip;and retrieve it on <code>arrived</code>.</p>
<pre><code>arrived(elem) {
  var visited = window.localStorage.getItem('visited')
  var msg = visited ? "Welcome back!" : "Welcome!"
  elem.querySelector('.welcome').textContent = msg
}
</code></pre>
      <p>(Note that the <code>departed</code> function only executes when the page's URL changes, not when the page is reloaded.)</p>
      <h2>Parameters</h2>
      <p>In these examples, we just used the <code>elem</code> parameter. There are three parameters you can supply to the lifecycle functions in total. In order:</p>
      <ul>
        <li><strong><code>elem</code></strong>: the route element (the element carrying the route <code>id</code>)</li>
        <li><strong><code>params</code></strong>: any <a href="#params?foo=bar">params</a> passed to the route in a query string, converted to an object</li>
        <li><strong><code>routes</code></strong>: the whole routes object for convenience</li>
      </ul>
      </div>
      <div id="subsections">
        <h1>Subsections</h1>
        <p>When you <a href="#a-subsection">link to a subsection</a> from within a route that is already active, it just behaves as a basic hash fragment and no JavaScript is fired.</p>
        <div id="a-subsection">
          <h2>A subsection</h2>
          <p>Alternatively, if you link to a subsection in a <em>different</em> route, like the <a href="#focus-management">subsection about focus management</a> on the Home page, the route is revealed, envents and methods fired, and the subsection brought into view.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque dignissim molestie diam. Integer fermentum nisi eget vehicula tristique. Vivamus leo justo, pharetra quis euismod ac, vestibulum non neque. Ut eget est sem. Ut quis ultricies mauris. Donec mauris tortor, posuere non mi ac, accumsan rutrum sapien.</p>
          <p>Phasellus suscipit libero blandit sapien feugiat, vel mattis velit venenatis. Aenean eu ligula viverra tellus accumsan cursus ut et lorem. Donec non laoreet ex. In vitae turpis felis. Nam sollicitudin sit amet orci et hendrerit. Nulla congue dictum finibus.</p>
          <p>Ut ut ligula porttitor purus dictum faucibus. Aliquam suscipit dui in augue pharetra, sed pellentesque dolor fringilla. Donec ornare est eget sapien tristique rutrum. Nulla facilisi. Praesent nec euismod leo. Morbi nunc dui, rhoncus quis massa ut, mollis gravida mauris. Praesent quis nisl ut ipsum ultrices mollis. Vivamus at ex orci.</p>
        </div>
      </div>
      <div id="params">
        <h1>Using params</h1>
      </div>
    </main>
    <script src="../xiao.js"></script>
    <script>
      var app = new Xiao(
        [
          {
            id: 'home',
            label: 'Home'
          },
          {
            id: 'subsections',
            label: 'Subsections within routes'
          },
          {
            id: 'lifecycle',
            label: 'Route lifecycle',
            arrived(elem) {
              var time = Date.now();
              var timeElem = elem.querySelector('.timestamp')
              timeElem.textContent = `Route arrival timestamp: ${time}`
              var visited = window.localStorage.getItem('visited')
              var msg = visited ? "Welcome back!" : "Welcome!"
              elem.querySelector('.welcome').textContent = msg
            },
            departed(elem) {
              window.localStorage.setItem('visited', true)
            }
          },
          {
            id: 'params',
            label: 'Params example',
            arrived(elem, params, routes) {

            },
            departed(elem, params, routes) {

            }
          }
        ],
        'home'
      )

      window.addEventListener('reroute', e => {
        console.log('Old route:', e.detail.oldRoute)
      })
    </script>
  </body>
</html>
